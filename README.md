### 扫描器

### 功能

- 网页分析 -S
- 目录爆破 -B
- 端口扫描 -P
- SQL注入检测 -I
- 存活主机探测 -H
- 子域名挖掘 -D
- 弱口令检测 -L
- 待开发



### 想法

整合主流的扫描器，用一个脚本对网站展开一站式简易扫描。

有大佬留言可以用redis+celery进行分布式的开发，目前正在研究中。

初步重构并去除冗余代码，希望耦合度能更高方便日后增加新功能。

详细的想法请访问：[金浩的个人博客](https://www.keyboy.xyz/2019/10/29/%E5%85%B3%E4%BA%8E%E4%B8%AA%E4%BA%BA%E7%BC%96%E5%86%99%E7%9A%84web%E6%89%AB%E6%8F%8F%E5%99%A8%E6%A6%82%E8%BF%B0/)



### 运行环境

python3

`pip install -r requirements.txt`


### todo
- 添加自定义请求头
- 增加正则匹配库，自动匹配返回包中的敏感信息(完成)
- 改用grequests库进行发包，提升发包效率(完成)
- 输出信息以不同颜色进行分类，方便查看(完成)
- 输出结果将整合进一个文件，并丰富信息量


### 结构
文件夹 | 用途
--- | ---
dict | 预存payload字典
lib | 具体功能模块
modules | 底层工具类
reports | 保存输出结果
Sqliscan | sql检测功能
sqlmapapi | sqlmapapi组件
main.py | 入口启动文件
config.ini | 配置文件

### config.ini参数
各数值已调配至合适的范围，可根据实际情况进行修改  
`section`名称对应模块名称  
`threads/max_workers`对应该模块的网络请求线程数量，数值越大执行速度越快，但要考虑网站的承受能力  
`timeout`对应该模块的请求超时等待时间，在网络条件不好的情况下适当增大数值可获取更准备的结果  
`recursion`对应脚本最大递归深度  

Scan模块下的参数  
`ICPUrl`对应站长之家的ICP查询接口  
`checkWebStatus`开启时将请求扫描得到的url以检测其存活性，帮助分析  
`checkJsStatus`开启时将分析页面的JS文件  

Domain模块下的参数  
`domain2IP`统计子域名对应IP的分布情况  
`showIP`是否展示IP分布情况，开关与否均会保存结果至文件  

### 主要模块实现
#### module:scan  
该模块会提取页面的链接并测试其能否访问，同时收集页面中的邮箱及手机号等信息。  
添加选项`x`后，将同时爬取页面JS链接，提取其中的中文（易存在注释等敏感信息），同时拼凑出JS中的路径，帮助分析网站。  

#### module:domain  
该模块会以字典的形式拼凑子域名并进行爆破。  
添加选项`x`后，将改用从DNS解析记录商中获取DNS记录，并检测其存活性，能覆盖字典外的子域名。  

#### module:burp
该模块会自动识别网站类型并调用相应的路径字典进行爆破。  


### 不足

- 根据多次测试，感觉成功率并不能令人满意。网上综合环境过于复杂，很难把细节都考虑周全，每次都是自己用着发现哪里有不满意了再进行修补。
- 能用celery调用其它模块了，但整体速度反而下降了很多。
- 没有添加真正的分布式任务布局，没有添加扩展递归扫描，另还有很多celery的bug没有处理好。
- 在windows环境下运行极慢，有待优化



### 声明

- 本扫描器不可用作一切非法用途。